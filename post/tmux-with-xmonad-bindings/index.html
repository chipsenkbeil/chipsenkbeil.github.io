<!DOCTYPE html>
<html 
    lang="en-us"
    class="no-js"
>



<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="Your name">
    <meta name="description" content="Your description">
    
    <meta name="generator" content="Hugo 0.15-DEV" />
    <meta name="generation-date" content="2015-09-29 18:45:39.109398104 &#43;0000 UTC">
    <title>tmux with XMonad Bindings &middot; Senkbeil</title>
    <link rel="shortcut icon" href="http://chipsenkbeil.com/img/favicon.ico">
    <link rel="icon" href="http://chipsenkbeil.com/img/favicon.ico">
    
<link rel="stylesheet" href="http://chipsenkbeil.com/css/materialize.min.css">


<link rel="stylesheet" href="http://chipsenkbeil.com/css/font-awesome.min.css">


    
    <link rel="stylesheet" href="http://chipsenkbeil.com/css/styles/railscasts.css">



<link rel="stylesheet" href="http://chipsenkbeil.com/css/lightbox.css">


<link rel="stylesheet" href="http://chipsenkbeil.com/css/main.css">


    <script src="http://chipsenkbeil.com/js/modernizr-latest.js"></script>
    <script src="http://chipsenkbeil.com/js/lazysizes.min.js"></script>
    <script src="http://chipsenkbeil.com/js/ls.noscript.min.js"></script>

    <script>
        window.lazySizesConfig = window.lazySizesConfig || {};
        lazySizesConfig.addClasses = true;
        lazySizesConfig.loadMode = 2;
    </script>

    
</head>



<body class="page-colors minimum-viewport-height">
    
<nav class="main-menu menu-colors">
    <ul class="menu menu-colors no-list-float">
        <li><a href="http://chipsenkbeil.com/"><i class="fa fa-home fa-2x"></i></a></li>
        <li>
            <a href="#!"><i class="fa fa-bars fa-2x"></i></a>

            
            <ul class="menu flexible-width menu-colors no-list-float">
                
                
                    <li >
                    
                        <a href="#!">
                            
                            <span>About</span>
                            <span class="drop-right"></span>
                            
                        </a>
                        <ul class="menu flexible-width menu-colors no-list-float">
                            
                                <li >
                                    <a href="/pepper/">Pepper</a>
                                </li>
                            
                                <li >
                                    <a href="/resume/">Resume</a>
                                </li>
                            
                        </ul>
                    
                    </li>
                
                    <li >
                    
                        <a href="#!">
                            
                            <span>Blog</span>
                            <span class="drop-right"></span>
                            
                        </a>
                        <ul class="menu flexible-width menu-colors no-list-float">
                            
                                <li >
                                    <a href="/note/">Notes</a>
                                </li>
                            
                                <li >
                                    <a href="/post/">Posts</a>
                                </li>
                            
                                <li >
                                    <a href="#!">Snippets</a>
                                </li>
                            
                                <li >
                                    <a href="/talk/">Talks</a>
                                </li>
                            
                        </ul>
                    
                    </li>
                
                    <li >
                    
                        <a href="#!">
                            
                            <span>Projects</span>
                            <span class="drop-right"></span>
                            
                        </a>
                        <ul class="menu flexible-width menu-colors no-list-float">
                            
                                <li >
                                    <a href="#!">Hardware</a>
                                </li>
                            
                                <li >
                                    <a href="/software/">Software</a>
                                </li>
                            
                        </ul>
                    
                    </li>
                
            </ul>
        </li>
        <li><a href="#!" data-lightbox-id="searchbox"><i class="fa fa-search fa-2x"></i></a></li>
        
            <li class="blue-grey-text" style="border-top: 1px solid;"></li>
            
                <li>
                    <a href="https://twitter.com/ChipSenkbeil">
                        <i class="fa fa-twitter fa-2x"></i>
                    </a>
                </li>
            
                <li>
                    <a href="https://www.linkedin.com/in/robertsenkbeil">
                        <i class="fa fa-linkedin fa-2x"></i>
                    </a>
                </li>
            
                <li>
                    <a href="https://www.google.com/&#43;ChipSenkbeil">
                        <i class="fa fa-google-plus fa-2x"></i>
                    </a>
                </li>
            
                <li>
                    <a href="https://www.github.com/chipsenkbeil">
                        <i class="fa fa-github fa-2x"></i>
                    </a>
                </li>
            
        
        <li class="blue-grey-text" style="border-top: 1px solid;"></li>
        <li>
            <a href="" type="application/rss+xml" target="_blank">
                <i class="fa fa-rss fa-2x"></i>
            </a>
        </li>
    </ul>
</nav>

<div id="searchbox" class="no-display">
    <div class="valign-wrapper fill-container">
        <div class="valign large-form horizontal-center-hack">
            <form method="get" id="search" action="http://duckduckgo.com/">
    <input type="hidden" name="sites"value="http://chipsenkbeil.com/"/>
    <input type="hidden" name="ka" value="h"/>
    <input type="hidden" name="k7" value="#fafafa"/>
    <input type="hidden" name="kj" value="#3f3f3f"/>
    <input type="hidden" name="ky" value="#fafafa"/>
    <input type="hidden" name="kx" value="b"/>
    <input type="hidden" name="kt" value="Helvetica"/>
    <input type="text" name="q" maxlength="255" placeholder="Search"/>
    <input type="submit" value="DuckDuckGo Search" style="visibility: hidden;" />
</form>


        </div>
    </div>
</div>





    <div class="main-content">
        <div class="center-space">
            <div class="article-colors">
                
                <article>
                    <header>
                        <h1 class="article-title">tmux with XMonad Bindings</h1>
                        <time class="date-color">Tue Dec 24, 2013</time>
                        <span class="separator">|</span>
                        <ul class="categories">
    <li>
        <i class="fa fa-book"></i>
    </li>
    
        <li><a href="/categories/tool">tool</a></li>
    
</ul>


                        <span class="separator">|</span>
                        <ul class="tags">
    <li>
        <i class="fa fa-tags"></i>
    </li>
    
        <li><a href="/tags/tmux">tmux</a></li>
    
        <li><a href="/tags/xmonad">xmonad</a></li>
    
</ul>


                    </header>

                    <hr>

                    <section>
                        
                            

<h3 id="the-reason:a0c2a1a5858b0f1c106304ad52083fb2">The Reason</h3>

<p>I&rsquo;ve been playing around with <code>tmux</code> a lot lately and have come to like it
quite a lot for the panes and windows - something I used quite a lot with my
XMonad setup on my old Fujitsu laptop. The panes act as my individual
terminals with which I can write code, read documentation, chat on IRC (using
<code>weechat</code> or <code>irssi</code>), play music, etc. In other words, I do quite a lot from
within terminals and being able to split up a terminal into panes (like XMonad
launching tiled terminals) is quite nice. Furthermore, treating the windows
as my workspaces lets me quickly organize myself just like with XMonad.</p>

<p>However, the main issue I have found with tmux is with its keyboard bindings.
Everything in tmux is bound to a prefix (Ctrl-b) followed by a single keystroke
or multiple keystrokes. For instance, splitting a window into two horizontal
panes is the sequence <code>Ctrl-b &quot;</code> and splitting it horizontally is <code>Ctrl-b %</code>.
I pride myself in being able to pick up things like this quickly, but my mind
continued to nag me about the need of a prefix as well as the use of keys like
double quotes and percent. I was used to XMonad, where creating a new pane
involved a single <code>Mod-Shift-Enter</code> and navigating between tiles was a simple
<code>Mod-Tab</code>. Because of this, I began to look into ways to rebind tmux keys to
be more like XMonad.</p>

<h3 id="the-process:a0c2a1a5858b0f1c106304ad52083fb2">The Process</h3>

<p>tmux provides multiple ways to rebind keys and perform startup actions. The
first is to execute the actions from the terminal:</p>

<pre><code class="language-raw">tmux bind-key d kill-pane
</code></pre>

<p>Another option is to perform the task within a running tmux instance by
entering <code>Ctrl-b :</code>, which enters a command mode for you to enter tmux actions.</p>

<p>Of course, these methods were not what I needed. What I discovered was that
tmux could source a file to get its bindings. You could have <code>.tmux.conf</code>
within your home directory or use</p>

<pre><code class="language-raw">tmux source my_tmux.conf
</code></pre>

<p>For me, I began to work with the default <code>.tmux.conf</code> file. Keybindings were
easy to rebind using <code>bind-key</code> and <code>unbind-key</code>. For instance, if I wanted
to bind the space key to change the layout - XMonad uses <code>Mod-Space</code> by
default - I would use the following:</p>

<pre><code class="language-raw">bind-key Space next-layout
</code></pre>

<p>However, a simple <code>bind-key</code> does not remove the prefix! This means that the
above would actually be <code>Ctrl-b Space</code> as the combination. Luckily, tmux
provides a way to avoid the prefix when performing actions. The <code>-n</code> switch
indicates that no prefix should be used.</p>

<pre><code class="language-raw">bind-key -n C-Space next-layout
</code></pre>

<p>The above indicates that the series of keystrokes <code>Ctrl-Space</code> should change
the layout used in tmux, no prefix needed.</p>

<h3 id="the-issue:a0c2a1a5858b0f1c106304ad52083fb2">The Issue</h3>

<p>The issue I discovered was that modifier keys - Control, Shift, Function, Alt -
were not fully supported in tmux. In fact, modifier keys are not fully
supported in a lot of applications. Instead, you see certain keycodes appear
when a modifier key is used in combination with a normal key. If you execute
<code>xmodmap</code> in your terminal, you should get a list of modifier keys in your
computer. Entering <code>xmodmap -pk</code> into your terminal yields the actual table
containing the representations of each key without modifiers, with the shift
key, with the mode switch key, with the shift and mode switch keys, with the
alt key, and with the alt and shift keys. If you print this table, you&rsquo;ll
notice that quite a few keys do not have bindings for shift/mode switch keys.</p>

<p>Furthermore, after looking at tmux&rsquo;s source, it appears that only certain keys
are checked for modifiers before passing the keystroke to the application
running within tmux. Because of this, I cannot use a setup like
<code>Ctrl-Shift-Return</code> for creating a new terminal tile using standard tmux.</p>

<h3 id="the-potential-solution:a0c2a1a5858b0f1c106304ad52083fb2">The Potential Solution</h3>

<p>At least, I did not believe that I could. I discovered that tmux provided even
more functionality through the ability to not only launch shell programs but
also check the return status of said programs!</p>

<pre><code class="language-raw"># Run command if system is Mac OS X
if-shell 'test `uname` == &quot;DARWIN&quot;' &lt;COMMAND&gt; [OPTIONAL COMMAND]
</code></pre>

<p>Because of this ability, I thought about having a small program that could be
executed to indicate whether modifier keys like control and shift were
currently being pressed down. Returning success indicates they were and
returning failure indicates they were not.</p>

<p>The challenge appeared when I realized that modifier keys were mostly unable
to be tracked in this manner. tmux itself was not at fault for this limitation;
so, I had to dig deeper to find out how to retrieve this bindings. I had seen
some utilities that could detect shift and control key presses, but they were
bound in the X11 system, which I did not want to impose as a restriction for my
setup. In fact, my hope was that this could be run very easily without an X11
system. Furthermore, as a new owner of a Macbook Air - Linux will be put on it
soon enough - I wanted this to be able to work on OS X as well.</p>

<h3 id="the-mac-os-x-solution:a0c2a1a5858b0f1c106304ad52083fb2">The Mac OS X Solution</h3>

<p>Cocoa provides the functionality to directly check if modifier keys are
pressed, which is incredibly useful. So, I simply wrote a small Cocoa
application that returns success based on the state of modifier keys. The
documentation indicates that Mac OS X v10.6+ is needed to use this
functionality; so, this means my solution will only work for Snow Leopard or
higher (sorry Leopard and Tiger).</p>

<p>You can find the small program bundled with the main project
<a href="/software/tmux-xmonad-bindings/">here</a>.</p>

<h3 id="the-linux-solution:a0c2a1a5858b0f1c106304ad52083fb2">The Linux Solution</h3>

<p>This took a little digging before I realized that I needed to access the
keyboard interface directly, rather than accessing information from a
program. This meant accessing <code>/dev/my_keyboard_interface</code>, which would vary
from computer to computer.</p>

<p>I wrote a small C program to demonstrate this functionality
<a href="/software/keyboard-state/">here</a>.</p>

<p>Unfortunately, after joining IBM in January of 2014, I was not able to
continue pursuing this project.</p>

<h3 id="the-final-result:a0c2a1a5858b0f1c106304ad52083fb2">The Final Result</h3>

<p>Overall, the configuration combined with the modifier keys captured by an
external program successfully produced a working replica of XMonad&rsquo;s key
bindings using tmux, giving me a more comfortable layout for moving
panes and navigating.</p>

<p>You can find the project <a href="/software/tmux-xmonad-bindings/">here</a>.</p>

                        
                    </section>

                    <footer class="right-align">
                        <p><small>Copyright &#169; by Chip Senkbeil</small></p>
                    </footer>

                    
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_shortname = 'chipsenkbeil';
        var disqus_identifier = 'http:\/\/chipsenkbeil.com\/post\/tmux-with-xmonad-bindings\/';
        var disqus_title = 'tmux with XMonad Bindings';
        var disqus_url = 'http:\/\/chipsenkbeil.com\/post\/tmux-with-xmonad-bindings\/';
        (function() {
            
            if (window.location.hostname === "localhost") {
                return;
            }

            var dsq = document.createElement('script'); 
            dsq.type = 'text/javascript'; 
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';

            (document.getElementsByTagName('head')[0] || 
                document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>



                </article>
            </div>
        </div>
    </div>

    
<script src="http://chipsenkbeil.com/js/jquery-2.1.4.min.js"></script>


<script src="http://chipsenkbeil.com/js/materialize.min.js"></script>


<script src="http://chipsenkbeil.com/js/imagesloaded.pkgd.min.js"></script>


<script src="http://chipsenkbeil.com/js/masonry.pkgd.min.js"></script>


    
    <script src="http://chipsenkbeil.com/js/highlight.pack.js"></script>



<script src="http://chipsenkbeil.com/js/lightbox.min.js"></script>


<script src="http://chipsenkbeil.com/js/jquery.infinitescroll.min.js"></script>


<script src="http://chipsenkbeil.com/js/main.js"></script>


</body>

</html>





